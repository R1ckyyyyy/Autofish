# Autofish

Autofish 是一个基于 Python 的自动化钓鱼工具，专为特定游戏场景设计。它利用计算机视觉（OpenCV）识别游戏状态，通过模拟鼠标和键盘输入（PyInput/ctypes）自动执行钓鱼操作，并使用 OCR 技术记录渔获信息。项目采用 PySide6 和 QFluentWidgets 构建了现代化的图形用户界面。

## 架构概览

项目遵循模块化设计，主要分为以下几个部分：

*   **GUI 层 (`src/gui/`)**: 负责用户交互、状态显示和参数配置。
*   **业务逻辑层 (`src/workers.py`)**: 包含核心的自动化工作流线程。
*   **基础设施层**:
    *   `src/vision.py`: 图像处理与识别。
    *   `src/inputs.py`: 输入模拟与监听。
    *   `src/config.py`: 配置管理与持久化。
*   **资源与配置**:
    *   `resources/`: 存放用于模板匹配的图片资源。
    *   `config/`: 存放用户配置文件 `config.json`。
    *   `data/`: 存放渔获记录 `records.csv`。

## 核心逻辑流程图

```mermaid
graph TD
    A[启动脚本 (F2)] --> B{环境预检}
    B -- 失败 --> C[暂停并提示]
    B -- 成功 --> D[抛竿阶段]
    D --> E{检测抛竿提示}
    E -- 找到 --> F[长按鼠标抛竿]
    E -- 超时 --> D
    F --> G[等待咬钩]
    G --> H{监控鱼饵数量减少}
    H -- 减少 --> I[收杆阶段]
    H -- 超时 --> D
    I --> J[按住鼠标收线]
    J --> K[松开鼠标回气]
    K --> L{检测星星图标?}
    L -- 是 --> M[收杆完成]
    L -- 否 (循环) --> I
    M --> N[记录渔获 (OCR)]
    N --> O[保存 CSV/截图]
    O --> P[点击确认/关闭]
    P --> Q[等待循环间隔]
    Q --> D
```

## 注意事项

*   **配置**: 配置文件位于 `config/config.json`，支持自定义不同鱼竿的参数。
*   **依赖**: 强依赖于游戏窗口的分辨率和 UI 布局。虽然有缩放逻辑，但核心识别区域（Regions）可能需要根据实际游戏更新进行微调。
*   **调试**:
    *   主要通过 GUI 的日志窗口观察运行状态。
    *   `screenshots/` 目录下可能会生成调试截图（如果代码中开启了调试保存）。
